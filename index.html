<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>专转 拽专 - 专 砖专 </title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>

    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f3f4f6; }
        .card { background: white; border-radius: 12px; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <header class="bg-indigo-600 text-white p-6 shadow-lg text-center">
        <h1 class="text-3xl font-bold"> 专 砖专  - 转 '</h1>
        <p class="mt-2 text-indigo-100">转, 转拽  拽专!</p>
    </header>

    <div class="max-w-4xl mx-auto p-4 space-y-6">

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div class="card p-6 text-center border-b-4 border-green-500">
                <h2 class="text-gray-500 font-semibold mb-2">住" 拽转 转转转</h2>
                <div id="total-minutes" class="text-5xl font-bold text-green-600">注...</div>
                <p class="text-sm text-gray-400 mt-2">注 砖: 1000 拽转!</p>
            </div>

            <div class="card p-6 text-center border-b-4 border-blue-500">
                <h2 class="text-gray-500 font-semibold mb-2">住驻专  砖砖</h2>
                <div id="total-workouts" class="text-5xl font-bold text-blue-600">注...</div>
                <p class="text-sm text-gray-400 mt-2">  砖!</p>
            </div>
        </div>

        <div class="card p-6">
            <h2 class="text-xl font-bold mb-4 text-gray-700"> 转拽转 转</h2>
            <canvas id="readingChart" height="100"></canvas>
        </div>

        <div class="card p-6">
            <h2 class="text-xl font-bold mb-4 text-gray-700">  专 砖</h2>
            <ul id="recent-list" class="divide-y divide-gray-100">
                <li class="py-2 text-gray-500">注 转...</li>
            </ul>
        </div>

    </div>

    <script>
        // 拽砖专 砖 (转  砖注  拽)
        const sheetUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vS7Ef224-e8pl9hy_11eOY3QGy3JX4plIeurKRjQscqRhlXrYR9Aera79dcgbYqx6so_SZ_asei0S7h/pub?gid=379096617&single=true&output=csv';

        Papa.parse(sheetUrl, {
            download: true,
            header: true,
            complete: function(results) {
                processData(results.data);
            }
        });

        function processData(data) {
            let totalMinutes = 0;
            let totalWorkouts = 0;
            let dailyMinutes = {};
            
            // 拽 注 转
            const cleanData = data.filter(row => row['砖 转/'] && row['拽转']); // 住 砖专转 专拽转

            cleanData.forEach(row => {
                // 砖 拽转
                const mins = parseInt(row['拽转']) || 0;
                totalMinutes += mins;
                totalWorkouts++;

                //  专祝 (拽抓 驻 转专)
                const date = row['转专'];
                if (dailyMinutes[date]) {
                    dailyMinutes[date] += mins;
                } else {
                    dailyMinutes[date] = mins;
                }
            });

            // 注 住驻专 住
            document.getElementById('total-minutes').innerText = totalMinutes.toLocaleString();
            document.getElementById('total-workouts').innerText = totalWorkouts.toLocaleString();

            // 注 专砖转 专 (拽 转 -5 专 专砖)
            const recentList = document.getElementById('recent-list');
            recentList.innerHTML = '';
            // 驻 转 专砖  专转 转 砖 转专 注, 拽 5
            cleanData.slice().reverse().slice(0, 5).forEach(row => {
                const li = document.createElement('li');
                li.className = "py-3 flex justify-between items-center";
                li.innerHTML = `
                    <div>
                        <span class="font-bold text-gray-800">${row['砖 转/']}</span>
                        <span class="text-gray-500 text-sm">拽专/ "${row[' 拽专/']}"</span>
                    </div>
                    <span class="bg-indigo-100 text-indigo-800 text-xs font-semibold px-2.5 py-0.5 rounded">${row['拽转']} 拽'</span>
                `;
                recentList.appendChild(li);
            });

            // 转 专祝
            renderChart(dailyMinutes);
        }

        function renderChart(dailyData) {
            const ctx = document.getElementById('readingChart').getContext('2d');
            
            // 专 注专 砖 专祝
            const labels = Object.keys(dailyData); 
            const dataPoints = Object.values(dailyData);

            new Chart(ctx, {
                type: 'bar', // 住 专祝: 注转
                data: {
                    labels: labels,
                    datasets: [{
                        label: '拽转 拽专 转',
                        data: dataPoints,
                        backgroundColor: 'rgba(99, 102, 241, 0.6)',
                        borderColor: 'rgba(99, 102, 241, 1)',
                        borderWidth: 1,
                        borderRadius: 5
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: { beginAtZero: true }
                    }
                }
            });
        }
    </script>
</body>
</html>
